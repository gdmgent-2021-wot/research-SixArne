<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tensorflow | Computer vision</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="Documentation on computer vision">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/research-SixArne/assets/css/0.styles.8fe9dbf4.css" as="style"><link rel="preload" href="/research-SixArne/assets/js/app.be2f8ba4.js" as="script"><link rel="preload" href="/research-SixArne/assets/js/2.556af13f.js" as="script"><link rel="preload" href="/research-SixArne/assets/js/13.67d86d86.js" as="script"><link rel="prefetch" href="/research-SixArne/assets/js/10.17deb8f3.js"><link rel="prefetch" href="/research-SixArne/assets/js/11.7dc8ee57.js"><link rel="prefetch" href="/research-SixArne/assets/js/12.93544f98.js"><link rel="prefetch" href="/research-SixArne/assets/js/14.9b545085.js"><link rel="prefetch" href="/research-SixArne/assets/js/15.dde34d1b.js"><link rel="prefetch" href="/research-SixArne/assets/js/16.5daec0bc.js"><link rel="prefetch" href="/research-SixArne/assets/js/17.5dcf64be.js"><link rel="prefetch" href="/research-SixArne/assets/js/18.e6d22cad.js"><link rel="prefetch" href="/research-SixArne/assets/js/19.cf24a61e.js"><link rel="prefetch" href="/research-SixArne/assets/js/20.ed1a5df7.js"><link rel="prefetch" href="/research-SixArne/assets/js/21.75f3b345.js"><link rel="prefetch" href="/research-SixArne/assets/js/3.b7ff3dd6.js"><link rel="prefetch" href="/research-SixArne/assets/js/4.2ad53764.js"><link rel="prefetch" href="/research-SixArne/assets/js/5.76ea75ea.js"><link rel="prefetch" href="/research-SixArne/assets/js/6.e416f727.js"><link rel="prefetch" href="/research-SixArne/assets/js/7.f931c09f.js"><link rel="prefetch" href="/research-SixArne/assets/js/8.d28c0c3f.js"><link rel="prefetch" href="/research-SixArne/assets/js/9.27944c69.js">
    <link rel="stylesheet" href="/research-SixArne/assets/css/0.styles.8fe9dbf4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/research-SixArne/" class="home-link router-link-active"><!----> <span class="site-name">Computer vision</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/research-SixArne/history/" class="nav-link">
  Geschiedenis
</a></div><div class="nav-item"><a href="/research-SixArne/introduction/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><a href="/research-SixArne/get-started/" class="nav-link router-link-active">
  Get Started
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/research-SixArne/history/" class="nav-link">
  Geschiedenis
</a></div><div class="nav-item"><a href="/research-SixArne/introduction/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><a href="/research-SixArne/get-started/" class="nav-link router-link-active">
  Get Started
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Get started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/research-SixArne/get-started/" aria-current="page" class="sidebar-link">Frameworks en talen</a></li><li><a href="/research-SixArne/get-started/teachable-machines.html" class="sidebar-link">Teachable machines</a></li><li><a href="/research-SixArne/get-started/tensorflow.html" aria-current="page" class="active sidebar-link">Tensorflow</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/research-SixArne/get-started/tensorflow.html#development-dependencies" class="sidebar-link">Development dependencies</a></li><li class="sidebar-sub-header"><a href="/research-SixArne/get-started/tensorflow.html#hello-world" class="sidebar-link">Hello world</a></li><li class="sidebar-sub-header"><a href="/research-SixArne/get-started/tensorflow.html#keras" class="sidebar-link">Keras</a></li><li class="sidebar-sub-header"><a href="/research-SixArne/get-started/tensorflow.html#dataset" class="sidebar-link">Dataset</a></li><li class="sidebar-sub-header"><a href="/research-SixArne/get-started/tensorflow.html#het-model-bouwen" class="sidebar-link">Het model bouwen</a></li><li class="sidebar-sub-header"><a href="/research-SixArne/get-started/tensorflow.html#visuele-presentatie" class="sidebar-link">Visuele presentatie</a></li><li class="sidebar-sub-header"><a href="/research-SixArne/get-started/tensorflow.html#extra" class="sidebar-link">Extra</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tensorflow"><a href="#tensorflow" class="header-anchor">#</a> Tensorflow</h1> <h2 id="development-dependencies"><a href="#development-dependencies" class="header-anchor">#</a> Development dependencies</h2> <ul><li>Tensorflow</li> <li>Python interpreter</li> <li>Numpy</li> <li>MatplotLib</li></ul> <p>In deze getting-started guide zullen we het basisproject namaken van de officiële tensorflow website. In dit project gaan
we een model trainen met data en vervolgens zal het model kunnen raden of het getoonde voorwerp herkend wordt of niet.</p> <p>Alle acties die ik hieronder zal bespreken zijn gemaakt in Google Colab en kan iedereen zelf uitproberen.
<a href="https://colab.research.google.com/drive/1dJa7sRhJjVnsUQWswBncHxmMXvcHw86A?usp=sharing" target="_blank" rel="noopener noreferrer">Google colab link<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h1 id="google-colab"><a href="#google-colab" class="header-anchor">#</a> Google colab</h1> <p>Google colab is een goede manier om je bezig te houden met computer visie and andere subdomeinen van Artificiële intelligentie.
Het laat ons toe om een externe computer te reserveren die de Python-taal heeft staan en rechtstreeks code op uit te voeren.
Zo krijgen we voor ons project een computer met 100 GB HDD en 12 GB RAM.</p> <h2 id="hello-world"><a href="#hello-world" class="header-anchor">#</a> Hello world</h2> <p>De eerste taak als een programmeur is kijken of je project correct werkt en alle bibliotheken geïmporteerd zijn. Dit doen we door de volgende code
in een code-blok te schrijven in ons document.</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">print</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>

<span class="token comment"># 2.3.0</span>
</code></pre></div><p>Allereerst importeren we Tensorflow als tf voor de klasse aanroeping korter te maken. vervolgens printen we het versienummer.
Als dit een nummer teruggeeft dan weten we dan het project correct werkt.</p> <p>We kunnen direct de andere hulp bibliotheken importeren en kijken of deze werken.</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token comment"># Main library</span>
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

<span class="token comment"># Helper libraries</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">print</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>

<span class="token comment"># 2.3.0</span>
</code></pre></div><h2 id="keras"><a href="#keras" class="header-anchor">#</a> Keras</h2> <p>In deze tutorial gaan we gebruik maken van Keras. Keras is een API die het ons makkelijker maakt voor modellen te trainen en in te stellen,
vroeger moest je Keras apart installeren, maar tegenwoordig zit deze samen met Tensorflow.</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras
</code></pre></div><h2 id="dataset"><a href="#dataset" class="header-anchor">#</a> Dataset</h2> <p>Zoals ieder machine learning algoritme heb je een dataset nodig om mee te starten. Deze dataset bevat meerdere afbeeldingen waarop ons object te vinden is.
voor dit voorbeeld zullen we gebruik maken van de &quot;Fashion MNIST dataset&quot;. Deze dataset bevat 70.000 afbeeldingen van kledingstukken die we in
10 rubrieken kunnen plaatsen.</p> <p>Gelukkig voor ons zit deze al in de Tensorflow bibliotheek.</p> <div class="language-py extra-class"><pre class="language-py"><code>fashion_mnist <span class="token operator">=</span> keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>fashion_mnist

<span class="token comment"># Deze dataset bevat meerdere elementen, de training's afbeeldingen, de labels met het juiste antwoord,</span>
<span class="token comment"># de test images voor als het model getrained is en de correctie labels.</span>
<span class="token punctuation">(</span>train_images<span class="token punctuation">,</span> train_labels<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>test_images<span class="token punctuation">,</span> test_labels<span class="token punctuation">)</span> <span class="token operator">=</span> fashion_mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>De labels zijn eigenlijk een array met waardes van 0-9, dus we zullen de labels zelf een naam moeten geven voor we de afbeeldingen analyseren.</p> <div class="language-py extra-class"><pre class="language-py"><code>class_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'T-shirt/top'</span><span class="token punctuation">,</span> <span class="token string">'Trouser'</span><span class="token punctuation">,</span> <span class="token string">'Pullover'</span><span class="token punctuation">,</span> <span class="token string">'Dress'</span><span class="token punctuation">,</span> <span class="token string">'Coat'</span><span class="token punctuation">,</span>
               <span class="token string">'Sandal'</span><span class="token punctuation">,</span> <span class="token string">'Shirt'</span><span class="token punctuation">,</span> <span class="token string">'Sneaker'</span><span class="token punctuation">,</span> <span class="token string">'Bag'</span><span class="token punctuation">,</span> <span class="token string">'Ankle boot'</span><span class="token punctuation">]</span>
</code></pre></div><p>Alle afbeeldingen hebben een 28x28 pixel formaat, dit aangezien computer visie het best werkt met een kleinere hoeveelheid pixels en nog beter met
enkel grijswaarden.</p> <p>Zoals het je waarschijnlijk al opgevallen is hebben we ook nog de MatPlotLib bibliotheek geïnstalleerd. Dit zorgt ervoor dat we een visuele representatie
hebben van ons algoritme.</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token comment"># Hier plotten we de eerste afbeelding met matplotlib.</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>train_images<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/color.png" alt="Color boot"></p> <p>Kleuren zoals wij het kennen worden meestal gekenmerkt door RGB of rood groen blauw. Computers gebruiken deze waardes echter niet, binnenin gebruiken ze float waardes van 0 tot 1.
Dus wij moeten deze waardes ook wiskundig omzetten.</p> <div class="language-py extra-class"><pre class="language-py"><code>train_images <span class="token operator">=</span> train_images <span class="token operator">/</span> <span class="token number">255.0</span>
test_images <span class="token operator">=</span> test_images <span class="token operator">/</span> <span class="token number">255.0</span>
</code></pre></div><p>Vervolgens gaan we MatplotLib gebruiken om de data correct weer te geven.</p> <div class="language-py extra-class"><pre class="language-py"><code>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>train_images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>binary<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span>class_names<span class="token punctuation">[</span>train_labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/collection.png" alt="Collection"></p> <h2 id="het-model-bouwen"><a href="#het-model-bouwen" class="header-anchor">#</a> Het model bouwen</h2> <p>Om een Tensorflow model te bouwen gaan we opnieuw gebruik maken van Keras en zullen we de data
eerst moeten transformeren om er vervolgens beter mee te werken.</p> <p>We beginnen met een model te configureren voor het gebruik van onze dataset.</p> <div class="language-py extra-class"><pre class="language-py"><code>model <span class="token operator">=</span> keras<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
    keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span>input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>De eerste chain zal ons image-array transformeren van 2D naar 1D. De eerste Dense methode zal ervoor zorgen
dat het neuraal netwerk 128 neuronen ter beschikking heeft. Deze monden dan uit op 10 resultaten.</p> <div class="language-py extra-class"><pre class="language-py"><code>model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Vervolgens gaan we het model compileren. De loss-functie zorgt voor de nauwkeurigheid van ons model, de optimizer bepaalt hoe het model
zich zal aanpassen op de gekregen data. En de metrics zal voor ons het training systeem volgen en de nauwkeurigheid loggen.</p> <div class="language-py extra-class"><pre class="language-py"><code>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_images<span class="token punctuation">,</span> train_labels<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div><p>Vervolgens starten we de training door het model te koppelen aan de afbeeldingen en labels.</p> <h1 id="testen-van-het-model"><a href="#testen-van-het-model" class="header-anchor">#</a> Testen van het model</h1> <p>Nu ons model getraind is moeten we ook testen of het werkt. We kunnen dit doen met de evaluate functie.</p> <div class="language-py extra-class"><pre class="language-py"><code>test_loss<span class="token punctuation">,</span> test_acc <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>test_images<span class="token punctuation">,</span>  test_labels<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nTest accuracy:'</span><span class="token punctuation">,</span> test_acc<span class="token punctuation">)</span>
</code></pre></div><p>Nu kunnen we beginnen met het echte werk, we geven het model een afbeelding en deze geeft dan een resultaat terug.</p> <div class="language-py extra-class"><pre class="language-py"><code>probability_model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>model<span class="token punctuation">,</span> 
                                         tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Softmax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

predictions <span class="token operator">=</span> probability_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_images<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Hier zien we dat we een array terugkrijgen met verschillende waarden. De waarde die het grootst is is wat de computer denkt dat de afbeelding voorstelt.</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>predictions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>test_labels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Als we de grootste waarde printen en deze dan vergelijken met het antwoord dan zien we dat de computer het correct geraden heeft.</p> <h2 id="visuele-presentatie"><a href="#visuele-presentatie" class="header-anchor">#</a> Visuele presentatie</h2> <p>Vervolgens gaan we 2 functies definiëren die ervoor gaan zorgen dat we de resultaten visueel kunnen zien op ons scherm.</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">plot_image</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> predictions_array<span class="token punctuation">,</span> true_label<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">:</span>
  true_label<span class="token punctuation">,</span> img <span class="token operator">=</span> true_label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> img<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
  plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>binary<span class="token punctuation">)</span>

  predicted_label <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>predictions_array<span class="token punctuation">)</span>
  <span class="token keyword">if</span> predicted_label <span class="token operator">==</span> true_label<span class="token punctuation">:</span>
    color <span class="token operator">=</span> <span class="token string">'blue'</span>
  <span class="token keyword">else</span><span class="token punctuation">:</span>
    color <span class="token operator">=</span> <span class="token string">'red'</span>

  plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;{} {:2.0f}% ({})&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>class_names<span class="token punctuation">[</span>predicted_label<span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token number">100</span><span class="token operator">*</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>predictions_array<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                class_names<span class="token punctuation">[</span>true_label<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                color<span class="token operator">=</span>color<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">plot_value_array</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> predictions_array<span class="token punctuation">,</span> true_label<span class="token punctuation">)</span><span class="token punctuation">:</span>
  true_label <span class="token operator">=</span> true_label<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
  plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  thisplot <span class="token operator">=</span> plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> predictions_array<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;#777777&quot;</span><span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  predicted_label <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>predictions_array<span class="token punctuation">)</span>

  thisplot<span class="token punctuation">[</span>predicted_label<span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
  thisplot<span class="token punctuation">[</span>true_label<span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
</code></pre></div><p>Nu kunnen we de code even testen of hij werkt.</p> <div class="language-py extra-class"><pre class="language-py"><code>i <span class="token operator">=</span> <span class="token number">0</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
plot_image<span class="token punctuation">(</span>i<span class="token punctuation">,</span> predictions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> test_labels<span class="token punctuation">,</span> test_images<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
plot_value_array<span class="token punctuation">(</span>i<span class="token punctuation">,</span> predictions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>  test_labels<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/result.png" alt="Result"></p> <p>Nu kunnen we meerdere afbeeldingen plotten en de resultaten direct zien.</p> <div class="language-py extra-class"><pre class="language-py"><code>num_rows <span class="token operator">=</span> <span class="token number">5</span>
num_cols <span class="token operator">=</span> <span class="token number">3</span>
num_images <span class="token operator">=</span> num_rows<span class="token operator">*</span>num_cols
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span>num_cols<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>num_rows<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_images<span class="token punctuation">)</span><span class="token punctuation">:</span>
  plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span>num_rows<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>num_cols<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
  plot_image<span class="token punctuation">(</span>i<span class="token punctuation">,</span> predictions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> test_labels<span class="token punctuation">,</span> test_images<span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span>num_rows<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>num_cols<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>
  plot_value_array<span class="token punctuation">(</span>i<span class="token punctuation">,</span> predictions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> test_labels<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/result_collection.png" alt="Result collecion"></p> <p>Ten slotte kunnen we het model gebruiken en kijken of deze de afbeelding herkend.</p> <div class="language-py extra-class"><pre class="language-py"><code>img <span class="token operator">=</span> test_images<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token comment"># Keras werkt liever met een batch van afbeeldingen, om 1 afbeeldingen te zien moeten</span>
<span class="token comment"># we deze toevoegen aan een lijst.</span>
img <span class="token operator">=</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-py extra-class"><pre class="language-py"><code>predictions_single <span class="token operator">=</span> probability_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>img<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>predictions_single<span class="token punctuation">)</span>
</code></pre></div><div class="language-py extra-class"><pre class="language-py"><code>plot_value_array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> predictions_single<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> test_labels<span class="token punctuation">)</span>
_ <span class="token operator">=</span> plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> class_names<span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="extra"><a href="#extra" class="header-anchor">#</a> Extra</h2> <p>Voor diegene die zelf dit algoritme willen toepassen heb ik hier een link geplaatst met datasets.</p> <p><a href="https://github.com/tensorflow/datasets/tree/master/docs/catalog" target="_blank" rel="noopener noreferrer">Datasets<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/research-SixArne/get-started/teachable-machines.html" class="prev">
        Teachable machines
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/research-SixArne/assets/js/app.be2f8ba4.js" defer></script><script src="/research-SixArne/assets/js/2.556af13f.js" defer></script><script src="/research-SixArne/assets/js/13.67d86d86.js" defer></script>
  </body>
</html>
